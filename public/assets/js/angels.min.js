function hideActiveStar(){$(".user-card").fadeOut(400,function(){$(this).remove();$(".stars circle.active").removeClass("active")})}function showNewAngelForm(c){c.preventDefault();var a=$(".stars-bg").offset().top+$(".stars-bg").height();var d=$(".main-menu").height();if($(".new-angel-form-container").height()==0){$("body, html").scrollTop(a-$(window).height());var b=$(".new-angel-form-container-inner").height();$(".new-angel-form-container").height(b)}$("body, html").animate({scrollTop:Math.max(a-d,0)},500,"linear",function(){$(".new-angel-form-container").height("auto")})}function hideNewAngelForm(){var a=$(".stars-bg").offset().top+$(".stars-bg").height();$("body, html").animate({scrollTop:Math.max(a-$(window).height(),0)},500,function(){$(".new-angel-form-container").height("auto")})}function showStar(f,b,i,j){hideActiveStar();var h=$('        <div class="user-card" style="display:none;">            <img width="100" height="100" class="img-circle angel-img" onload="$(this).fadeIn()">            <h6 class="angel-name"></h6>            <h6 class="angel-time"></h6>          </div>      ');var d=$(".user-card");var a=$($(".stars circle")[f]);var c=a.parent();h.find(".angel-img").attr("src",i);$(".stars").prepend(h);$(".user-card").fadeIn();var g=140;var e=160;h.css({left:((c.offset().left+parseInt(a.attr("cx")))*c.outerWidth()/873.296875)-(g/2),top:c.offset().top+parseInt(a.attr("cy"))-(e/2)-$(".stars-bg").offset().top})}var angles_slide;function random_angles(d){if(typeof window.reservedAngels!="undefined"&&window.reservedAngels.length){var a=window.reservedAngels.shift()}else{var c=d.length;var a=Math.floor(Math.random()*(c-1+1))+1}var g=d[a];while(!g){a=Math.floor(Math.random()*(c-1+1))+1;g=d[a]}var b=$("circle").length;var f=a%b;var e=$(".circle"+f);e.addClass("active");showStar(f,g.name,g.picture_url,g.donation_date)}function stopPlayingAngels(){clearInterval(angles_slide);angles_slide=false}$(".stars circle").click(function(){hideActiveStar();$(this).addClass("active");var c=$(this).parent().find("circle").index(this);var b=angels.length;var a=Math.floor(Math.random()*(b-1+1))+1;var d=angels[a];stopPlayingAngels();showStar(c,d.name,d.picture_url,d.donation_date)});$(".stars-bg").on("click",function(a){if($(".user-card").length&&!$(a.target).is("circle")&&!$(a.target).is(".user-card")&&!$(a.target).parents(".user-card").length&&(angles_slide===false)){random_angles(angels)}});var notFoundAlert=$("#alertNotFound");$(document).ready(function(){var a=3;$("#angels_name").autocomplete({delay:1000,source:function(e,c){var d=e.term;d=d.trim().replace(/\s{2,}/g," ");if((/\s+$/.test(e.term)||(d.split(" ").length>1))&&(d.length>=a)){var b={angel_name:d,_token:$('meta[name="csrf-token"]').attr("content")};$.post(searchUrl,b,c)}},minLength:a,select:function(b,c){c.item.value="";let angel=c.item;let angelsIds=jQuery.map(angels,function(e,d){return e.id});let itemIndex=$.inArray(angel.id,angelsIds);if(itemIndex==-1){itemIndex=angels.length;angels.push(angel)}let circlesNo=$("circle").length;let circleIndex=itemIndex%circlesNo;let circle=$(".circle"+circleIndex);circle.addClass("active");stopPlayingAngels();showStar(circleIndex,angel.name,angel.picture_url,angel.donation_date);$(b.target).val(c.item.label);return false},search:function(b,c){$("#alertNotFound").slideUp()},response:function(b,c){if(!c.content||!$.isArray(c.content)){$("#alertNotFound").slideDown()}}});$(".show-form-btn-container button, .open-new-angel-form").click(showNewAngelForm)});