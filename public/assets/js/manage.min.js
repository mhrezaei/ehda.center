$(document).ready(function(){sidebarInitiate();$("#divSideMother").css("height",$(window).height()-50);$(window).resize(function(){$("#divSideMother").css("height",$(window).height()-50)})});function rowHide(d,c){if(d=="auto"){var b=" .tableGrid"}else{var b="#"+d}var a=b+" #tr-"+c;$(a).slideUp();tabReload()}function heyCheck(){in_server=false;now=new Date();heyChecked=parseInt(localStorage.getItem("heyChecked"));if(now.getTime()-heyChecked>1000*60*10){in_server=true;localStorage.setItem("heyChecked",now.getTime())}if(in_server){$.ajax({url:url("manage/heyCheck"),dataType:"json",cache:false}).done(function(a){forms_log(a);localStorage.setItem("heyCheck",a.ok)})}if(localStorage.getItem("heyCheck")=="false"){loginAlert("on")}else{loginAlert("off")}setTimeout("heyCheck()",1000)}function loginAlert(a){$alert=$("#divHeyCheck");if(a=="on"){$alert.fadeIn("fast")}else{$alert.fadeOut("fast")}}function rowUpdate(e,d){if(e=="auto"){var c=" .tableGrid"}else{var c="#"+e}if(d=="0"){if($(c).length){forms_delaiedPageRefresh(1)}}else{var a=c+" #tr-"+d;var b=$(a+" .refresh ").html();var f=$(a+" .-rowCounter ").html();$(a).addClass("loading");$.ajax({url:b,cache:false}).done(function(g){$(a).html(g);$(a).removeClass("loading");$(a+" .-rowCounter ").html(f)})}}function tabReload(){var a=$("#divTab .refresh").html();var b=$("#divTab");if(!a){return}b.addClass("loading");forms_log(a);$.ajax({url:a,cache:false}).done(function(c){b.html(c);b.removeClass("loading")})}function divReload(c){var a=$("#"+c);var b=$("#"+c+" .refresh").html();if(!b){return}a.addClass("loading");forms_log(b);$.ajax({url:b,cache:false}).done(function(d){a.html(d);a.removeClass("loading")})}function masterModal(c,a){if(!a){a="lg"}var b="#masterModal-"+a;$(b+" .modal-content").html('<div class="modal-wait">...</div>').load(c,function(){$(".selectpicker").selectpicker()});$(b).modal()}function modalForm(e,b,c){if(!c){c="0"}var d="#"+e;var a=d+" form ";$(d).modal()}function search(c){var d=$("#"+c+" input[name=key]");var b=d.val();var a=$("#"+c).attr("action").replace("-key-",b);if(!b){return false}window.location=a;return false}function gridSelector(c,d){switch(c){case"tr":$("#gridSelector-"+d).prop("checked",!$("#gridSelector-"+d).is(":checked"));case"selector":if($("#gridSelector-"+d).is(":checked")){$("#tr-"+d).addClass("warning")}else{$("#tr-"+d).removeClass("warning")}gridSelector("buttonActivator");break;case"all":if($("#gridSelector-all").is(":checked")){$(".gridSelector").prop("checked",true);$("tr.grid").addClass("warning")}else{$(".gridSelector").prop("checked",false);$("tr.grid").removeClass("warning")}gridSelector("buttonActivator");break;case"count":var b=0;$(".gridSelector:checked").each(function(){b++});return b;case"get":var a="";var b=0;$(".gridSelector:checked").each(function(){d=$(this).attr("data-value");a+=d+",";b++});$("input[name=ids]").val(a);$("#txtCount").val(forms_pd(b+" مورد "));break;case"buttonActivator":if(gridSelector("count")>0){$("#action0").prop("disabled",false)}else{$("#action0").prop("disabled",true)}}}function posttypeFeatures(a){var e=$("#lblFeature-"+a);var f=$("#txtFeatures");var d=$("#txtMeta");var c=available_features[a][2];var b="";c.forEach(function(g){b+=g+", "});forms_log(b);if(f.val().indexOf(a)>=0){f.val(f.val().replaceAll(a,""));e.css("opacity","0.5");d.val(d.val().replaceAll(b,""))}else{f.val(f.val()+" "+a+" ");e.css("opacity","0.9");d.val(d.val()+b)}if(a=="full_history"&&f.val().indexOf("full_history")>=0&&f.val().indexOf("history_system")<0){posttypeFeatures("history_system")}if(a=="history_system"&&f.val().indexOf("full_history")>=0&&f.val().indexOf("history_system")<0){posttypeFeatures("full_history")}if(a=="basket"&&f.val().indexOf("basket")>=0&&f.val().indexOf("price")<0){posttypeFeatures("price")}if(a=="price"&&f.val().indexOf("basket")>=0&&f.val().indexOf("price")<0){posttypeFeatures("basket")}}function downstreamPhotoSelected(a){$(a).val($(a).val().replace(url(),""))}function downstreamPhotoPreview(a){$url=$(a).val();if($url){window.open(url($url))}}function sidebarToggle(a){if(!a){a=0}$current_sitation=localStorage.getItem("sidebar");if(!$current_sitation){$current_sitation="shown"}if($current_sitation=="shown"){$(".sidebar").hide();$("#sidebarHandle").removeClass("fa-chevron-right").addClass("fa-chevron-left");localStorage.setItem("sidebar","hidden");$("#page-wrapper").animate({"margin-right":0},a)}else{$("#page-wrapper").animate({"margin-right":200},a,function(){$(".sidebar").show();$("#sidebarHandle").removeClass("fa-chevron-left").addClass("fa-chevron-right")});localStorage.setItem("sidebar","shown")}return localStorage.getItem("sidebar")}function sidebarInitiate(){$current_sitation=localStorage.getItem("sidebar");if($current_sitation=="hidden"){localStorage.setItem("sidebar","shown");return sidebarToggle(0)}}function drawingProgress(e){var d=$("#divProgress");$(".-progressHide").parent().hide();d.parent().show();var a=parseInt(d.attr("aria-valuenow"));var f=parseInt(d.attr("aria-valuemax"));var b=a+e;var c=(b*100/f);if(c>100){c=100}d.attr("aria-valuenow",b).css("width",c.toString()+"%");$("#btnPrepare").click()}function drawingRandom(a){var b=$("#txtDrawingGuess");for($i=1;$i<100;$i++){setTimeout(function(){var c=Math.floor(Math.random()*(a))+1;b.val(forms_pd(c.toString()))},10*$i)}setTimeout(function(){$("#btnSubmit").click()},11*$i)}function drawingDelete(b,a){$.ajax({url:url("manage/club/save/draw_delete/"+b),cache:false}).done(function(c){divReload("divWinnersTable");rowUpdate("tblPosts",a)})}function roleAttachmentEffect(a){var b=$("#cmbStatus-"+a).val();var c=$("#btnRoleSave-"+a);c.removeClass("btn-warning btn-primary btn-danger");switch(b){case"ban":c.addClass("btn-warning");break;case"detach":c.addClass("btn-danger");break;default:c.addClass("btn-primary");break}c.fadeIn("fast");return null}function roleAttachmentSave(b,a,e){var c=$("#cmbStatus-"+a).val();var d=$("#btnRoleSave-"+a);$.ajax({url:url("manage/users/save/role/"+b+"/"+e+"/"+c),dataType:"json",cache:false}).done(function(f){divReload("divRole-"+a);rowUpdate("tblUsers",b)});return null}function permitClick(d,c){var b=d.attr("for");var a=d.attr("value");switch(c){case"0":c=0;break;case"1":c=2;break;case"2":c=2;break;default:if(a=="2"){c=0}else{c=2}}if(b=="locale"){permitUpdate(d.attr("checker"),c)}if(b=="permit"&&d.attr("hasLocale")=="0"){permitUpdate(d.attr("checker"),c)}if(b=="permit"&&d.attr("hasLocale")=="1"){$(".-"+d.attr("module")+"-"+d.attr("permit")+"-locale").each(function(){permitUpdate($(this).attr("checker"),c)})}if(b=="module"){$(".-"+d.attr("module")+"-permit").each(function(){permitClick($(this),c.toString())})}permitSpread()}function permitUpdate(b,c){var d=$("#txtPermissions");if(c>0){var a=d.val();if(a.search(b)<0){a=a+" "+b;d.val(a)}}else{d.val(d.val().replaceAll(b,""))}}function permitSpread(){var c=$("#txtPermissions").val();var b="fa-check-circle-o";var g="fa-circle-o";var d="fa-dot-circle-o";var a="text-success";var f="text-darkgray";var e="text-violet";$(".-permit-link").removeClass(a).removeClass(f).removeClass(e).children(".fa").removeClass(b).removeClass(g).removeClass(d);$(".-module").each(function(){var i=$(this).attr("module");var h=0;var j=0;$(".-"+i+"-permit").each(function(){var l=$(this).attr("permit");var k=0;var m=0;if($(this).attr("hasLocale")==1){$(".-"+i+"-"+l+"-locale").each(function(){var n=$(this).attr("locale");h++;k++;if(c.search(i+"."+l+"."+n)>=0){$(this).children(".-locale-handle").addClass(b);$(this).addClass(a).attr("value","2");j++;m++}else{$(this).children(".-locale-handle").addClass(g);$(this).addClass(f).attr("value","0")}});if(m==k){$(this).children(".-permit-handle").addClass(b);$(this).addClass(a).attr("value","2")}else{if(m==0){$(this).children(".-permit-handle").addClass(g);$(this).addClass(f).attr("value","1")}else{$(this).children(".-permit-handle").addClass(d);$(this).addClass(e).attr("value","0")}}}else{h++;if(c.search(i+"."+l)>=0){$(this).children(".-permit-handle").addClass(b);$(this).addClass(a).attr("value","2");j++}else{$(this).children(".-permit-handle").addClass(g);$(this).addClass(f).attr("value","0")}}});if(j==h){$(this).children(".-module-handle").addClass(b);$(this).addClass(a).attr("value","2")}else{if(j==0){$(this).children(".-module-handle").addClass(g);$(this).addClass(f).attr("value","1")}else{$(this).children(".-module-handle").addClass(d);$(this).addClass(e).attr("value","0")}}})};