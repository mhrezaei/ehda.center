Dropzone.autoDiscover=false;Dropzone.prototype.defaultOptions.url=dropzoneRoutes.upload;Dropzone.prototype.defaultOptions.addRemoveLinks=true;Dropzone.prototype.defaultOptions.dictRemoveFile="";Dropzone.prototype.defaultOptions.dictCancelUpload="";Dropzone.prototype.defaultOptions.dictFileTooBig=messages.errors.size;Dropzone.prototype.defaultOptions.dictInvalidFileType=messages.errors.type;Dropzone.prototype.defaultOptions.dictResponseError=messages.errors.server;Dropzone.prototype.defaultOptions.dictMaxFilesExceeded=messages.errors.size;var dropzoneOptions={init:{sending:function(e,g,f){f.append("_token",csrfToken);var h={};var d=$(".breadcrumb-folders li.current");if(d.length&&(typeof getFolderParents!=undefined)&&$.isFunction(getFolderParents)){var c=getFolderParents(d);c.each(function(){h[$(this).attr("data-instance")]=$(this).attr("data-key")})}f.append("externalFields",JSON.stringify(h));var a=$(this.element).find(":input").serializeArray();$.each(a,function(i,j){f.append(j.name,j.value)});var b=$('<div class="media-uploader-status"></div>');b.append('<button type="button" class="fa fa-times-circle upload-dismiss"></button>');b.append('<h2 class="media-uploader-status-text">'+messages.statuses.uploading+"</h2>");b.append('<div class="media-progress"><div class="media-progress-value"></div></div>');b.append('<div class="upload-detail"><div class="upload-filename"></div></div>');b.find(".upload-filename").html(e.name);$(".files-uploading-status").append(b);e.uploadResultElement=b},uploadprogress:function(c,a,b){c.uploadResultElement.find(".media-progress-value").width(a+"%")},error:function(d,b,f){$(d.previewElement).find(".dz-error-message").remove();if(f.status==422){var a=d.uploadResultElement;var e=$('<div class="upload-errors"></div>');var c=$("<ul></ul>");if(b.file){$.each(b.file,function(h,g){c.append($("<li></li>").html(pd(g)))})}e.append(c);a.append(e);a.addClass("error");a.find(".media-uploader-status-text").html(messages.statuses.failed)}},success:function(c,b){var a=c.uploadResultElement;a.find(".media-uploader-status-text").html(messages.statuses.success)}}};function updateTarget(a,c){if(a.getUploadingFiles().length===0&&a.getQueuedFiles().length===0){var e=a.getAcceptedFiles();var b=[];var d=$("#"+c);$.each(e,function(f,g){if(g.status=="success"){var h=$.parseJSON(g.xhr.response);b.push(h.file)}});if(b.length){d.val(JSON.stringify(b))}else{d.val("")}}}function removeFromServer(d,b){if(d.xhr){var a=$.parseJSON(d.xhr.response);var e=a;e._token=csrfToken;var c=b.find(":input").serializeArray();$.each(c,function(f,g){e[g.name]=g.value});$.ajax({url:dropzoneRoutes.remove,type:"POST",data:e})}}function refreshDropzone(a){a.removeAllFiles();var b=$(a.element).attr("data-var-name");$('.files-uploading-status[data-var-name="'+b+'"]').html("")};