String.prototype.replaceAll=function(a,b){var c=this;return c.replace(new RegExp(a,"g"),b)};$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});jQuery(function(c){selectFolder(c(".breadcrumb-folders .folder").first());var d=c(window),b=c(".media-sidebar"),e=c(".media-footer"),a=c(".media-router .media-menu-item");c(".breadcrumb-folders li a").click(function(g){g.preventDefault();var f=c(this).closest(".folder");selectFolder(f)});d.on("resize load",function(){var f=d.width();if(f<=900){c(".media-folder-menu").hide();c(".media-frame-title .menu-icon").on("click",function(){c(".media-folder-menu").show()});c(".media-folder-menu .close-sidebar").on("click",function(){c(".media-folder-menu").hide()})}else{c(".media-folder-menu").show()}if(f<=768){c(".media-sidebar").hide();c(".media-sidebar .close-sidebar").on("click",function(){c(".media-sidebar").hide()})}else{c(".media-sidebar").show()}});c("#thumbnail").selectable({selecting:function(j,k){var g=c(this),i=c(k.selecting),h=i.find("img").attr("src"),f=h.replace("img/","");if(!b.is(":visible")){b.show()}b.find(".file-details").show();b.find(".thumbnail-image img").attr("src",h);b.find(".details .filename").empty().text(f);g.find(".active").removeClass("active");i.addClass("active")},stop:function(i,j){var h=c("li.ui-selected").clone().removeClass("active ui-selected"),f=h.length,g=pd(f);e.find(".attachments-preview").empty().append(h);e.find(".count").empty().text("گزینش شده: "+g);c("#add-btn").val(h)}});c("#clear-list").on("click",function(){c("li.ui-selected").removeClass("active ui-selected");b.find(".file-details").hide();e.find(".attachments-preview").empty("active ui-selected");e.find(".count").empty().text("گزینش شده: "+pd("0"));c("#add-btn").val("")});a.on("click",function(g){g.preventDefault();a.removeClass("active");var f=c(this).addClass("active").data("page");c(".page").hide();c("#"+f).show()});c(document).on({click:function(){showFile(c(this).data("file"));useFile(c(this).data("file"))}},".thumbnail")});function forms_pd(a){if(!a){a="0"}a=a.toString();a=a.replaceAll(/1/g,"۱");a=a.replaceAll(/2/g,"۲");a=a.replaceAll(/3/g,"۳");a=a.replaceAll(/4/g,"۴");a=a.replaceAll(/5/g,"۵");a=a.replaceAll(/6/g,"۶");a=a.replaceAll(/7/g,"۷");a=a.replaceAll(/8/g,"۸");a=a.replaceAll(/9/g,"۹");a=a.replaceAll(/0/g,"۰");return a}function forms_digit_fa(d){return forms_pd(d);var e="";for(var b=0;b<d.length;b++){var c=d.charCodeAt(b);if(c>=48&&c<=57){var a=c+1584;e=e+String.fromCharCode(a)}else{e=e+String.fromCharCode(c)}}return e}function pd(a){return forms_digit_fa(a)}function selectFolder(b){var a=getFolderParents(b);$(".breadcrumb-folders .folder").removeClass("active");$(".folder .folder-icon").removeClass("fa-folder-open").addClass("fa-folder");$(".breadcrumb-folders li").removeClass("current");b.addClass("current");a.addClass("active");$(".breadcrumb-folders .active").each(function(d){$(this).find("span.folder-icon").first().removeClass("fa-folder").addClass("fa-folder-open")});var c=new FormData();c.append("key",b.attr("data-key"));c.append("instance",b.attr("data-instance"));c.append("_token",csrfToken);$.ajax({url:urls.getList,type:"POST",data:{key:b.attr("data-key"),instance:b.attr("data-instance")},success:function(d){$("#thumbnail").replaceWith($(d))}})}function refreshGallery(){selectFolder($(".breadcrumb-folders .folder.current"))}function getFolderParents(b){var a=b.children("a");return a.parents(".folder")}function eachUploadCompleter(){refreshGallery()}function getFileUrl(a){return $('[data-file="'+a+'"]').data("url")}function showFile(a){var b=getUrlParam("field_preview");if(b){$.ajax({url:route_preview,type:"post",data:{file:a},success:function(c){parent.document.getElementById(b).innerHTML=c}})}}function getUrlParam(c){var b=new RegExp("(?:[?&]|&)"+c+"=([^&]+)","i");var a=window.location.search.match(b);return(a&&a.length>1)?a[1]:null}function useFile(e){function b(n){var o=tinyMCEPopup.getWindowArg("window");o.document.getElementById(tinyMCEPopup.getWindowArg("input")).value=n;if(typeof(o.ImageDialog)!="undefined"){if(o.ImageDialog.getImageData){o.ImageDialog.getImageData()}if(o.ImageDialog.showPreviewImage){o.ImageDialog.showPreviewImage(n)}}tinyMCEPopup.close()}function j(n,o){parent.document.getElementById(o).value=n;if(typeof parent.tinyMCE!=="undefined"){parent.tinyMCE.activeEditor.windowManager.close()}if(typeof parent.$.fn.colorbox!=="undefined"){parent.$.fn.colorbox.close()}}function d(n){if(window.opener){window.opener.CKEDITOR.tools.callFunction(getUrlParam("CKEditorFuncNum"),n)}else{parent.CKEDITOR.tools.callFunction(getUrlParam("CKEditorFuncNum"),n);parent.CKEDITOR.tools.callFunction(getUrlParam("CKEditorCleanUpFuncNum"))}}function l(o){var r=o;var n=data.Properties["Width"];var q=data.Properties["Height"];window.opener.SetUrl(r,n,q)}function m(n){parent.document.getElementById(f).value=n;parent.window.closeFileManagerModal()}var a=getFileUrl(e);var f=getUrlParam("field_name");var i=getUrlParam("CKEditor");var h=getUrlParam("modal");var c=typeof data!="undefined"&&data.Properties["Width"]!="";var g=a.replace(route_prefix,"");var k=a.replace(route_prefix,"");if(window.opener||window.tinyMCEPopup||f||getUrlParam("CKEditorCleanUpFuncNum")||i){if(h&&f){m(a,f)}else{if(window.tinyMCEPopup){b(a)}else{if(f){j(a,f)}else{if(i){d(a)}else{if(c){l(a)}else{window.opener.SetUrl(a,g)}}}}}if(window.opener){window.close()}}else{window.opener.SetUrl(a,g)}};