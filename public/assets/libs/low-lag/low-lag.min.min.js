if(!window.console){console={log:function(){}}}var lowLag=new function(){this.someVariable=undefined;this.showNeedInit=function(){lowLag.msg("lowLag: you must call lowLag.init() first!")};this.load=this.showNeedInit;this.play=this.showNeedInit;this.audioTagTimeToLive=5000;this.sm2url="sm2/swf/";this.soundUrl="";this.debug="console";this.init=function(e){$("#lowLag").remove();$("body").append("<div id='lowLag'></div>");var d=undefined;if(e!=undefined){if(e.force!=undefined){d=e.force}if(e.audioTagTimeToLive!=undefined){lowLag.audioTagTimeToLive=e.audioTagTimeToLive}if(e.sm2url!=undefined){lowLag.sm2url=e.sm2url}if(e.urlPrefix!=undefined){lowLag.soundUrl=e.urlPrefix}if(e.debug!=undefined){lowLag.debug=e.debug}}var f="sm2";if(d!=undefined){f=d}else{if(typeof(webkitAudioContext)!="undefined"){f="webkitAudio"}else{if(navigator.userAgent.indexOf("Firefox")!=-1){f="audioTag"}}}switch(f){case"webkitAudio":this.msg("init webkitAudio");this.load=this.loadSoundWebkitAudio;this.play=this.playSoundWebkitAudio;this.webkitAudioContext=new webkitAudioContext();break;case"audioTag":this.msg("init audioTag");this.load=this.loadSoundAudioTag;this.play=this.playSoundAudioTag;break;case"sm2":this.msg("init SoundManager2");this.load=this.loadSoundSM2;this.play=this.playSoundSM2;lowLag.msg("loading SM2 from "+lowLag.sm2url);soundManager.setup({url:lowLag.sm2url,useHighPerformance:true,onready:lowLag.sm2Ready,debugMode:true});break}};this.sm2IsReady=false;this.sm2ToLoad=[];this.loadSoundSM2=function(c,d){if(lowLag.sm2IsReady){lowLag.loadSoundSM2ForReals(c,d)}else{lowLag.sm2ToLoad.push([c,d])}};this.loadSoundSM2ForReals=function(h,i){var g=lowLag.getTagFromURL(h,i);lowLag.msg("sm2 loading "+h+" as tag "+g);var h=lowLag.getURLArray(h);for(var j=0;j<h.length;j++){var f=lowLag.soundUrl+h[j];h[j]=f}soundManager.createSound({id:g,autoLoad:true,url:h})};this.sm2Ready=function(){lowLag.sm2IsReady=true;for(var c=0;c<lowLag.sm2ToLoad.length;c++){var d=lowLag.sm2ToLoad[c];lowLag.loadSoundSM2ForReals(d[0],d[1])}lowLag.sm2ToLoad=[]};this.playSoundSM2=function(b){lowLag.msg("playSoundSM2 "+b);soundManager.play(b)};this.getTagFromURL=function(c,d){if(d!=undefined){return d}return lowLag.getSingleURL(c)};this.getSingleURL=function(b){if(typeof(b)=="string"){return b}return b[0]};this.getURLArray=function(b){if(typeof(b)=="string"){return[b]}return b};this.webkitAudioContext=undefined;this.webkitAudioBuffers={};this.loadSoundWebkitAudio=function(g,f){var e=lowLag.getSingleURL(g);var f=lowLag.getTagFromURL(g,f);lowLag.msg("webkitAudio loading "+e+" as tag "+f);var h=new XMLHttpRequest();h.open("GET",lowLag.soundUrl+e,true);h.responseType="arraybuffer";h.onload=function(){lowLag.webkitAudioContext.decodeAudioData(h.response,function(a){lowLag.webkitAudioBuffers[f]=a},lowLag.errorLoadWebkitAudtioFile)};h.send()};this.errorLoadWebkitAudtioFile=function(b){lowLag.msg("Error loading webkitAudio: "+b)};this.playSoundWebkitAudio=function(f){lowLag.msg("playSoundWebkitAudio "+f);var e=lowLag.webkitAudioBuffers[f];var h=lowLag.webkitAudioContext;var g=h.createBufferSource();g.buffer=e;g.connect(h.destination);g.noteOn(0)};this.audioTagID=0;this.audioTagNameToElement={};this.loadSoundAudioTag=function(k,i){var j="lowLagElem_"+lowLag.audioTagID++;var i=lowLag.getTagFromURL(k,i);var k=lowLag.getURLArray(k);lowLag.audioTagNameToElement[i]=j;lowLag.msg("audioTag loading "+k+" as tag "+i);var n="";n+='<audio id="'+j+'" preload="auto" autobuffer>';for(var m=0;m<k.length;m++){var h=k[m];var l="audio/"+lowLag.getExtension(h);n+='  <source src="'+lowLag.soundUrl+h+'" type="'+l+'" />'}n+="</audio>";$("#lowLag").append(n)};this.playSoundAudioTag=function(f){lowLag.msg("playSoundAudioTag "+f);var g=lowLag.audioTagNameToElement[f];var h="lowLagCloneElem_"+lowLag.audioTagID++;$("#"+g).clone().attr("id",h).appendTo("#lowLag");var e=document.getElementById(h);lowLag.msg(f);if(lowLag.audioTagTimeToLive!=-1){setTimeout(function(){$("#"+h).remove()},lowLag.audioTagTimeToLive)}e.play()};this.getExtension=function(b){return b.substring(b.lastIndexOf(".")+1).toLowerCase()};this.msg=function(b){b="-- lowLag "+b;if(lowLag.debug=="both"||lowLag.debug=="console"){console.log(b+"<br>")}if(lowLag.debug=="both"||lowLag.debug=="screen"){$("#lowLag").append(b+"<br>")}}};